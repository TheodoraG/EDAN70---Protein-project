# EDAN70-proteinfolding

A CS project done together with Biochemistry

***

## Full Name
Protein Superimposition with Machine Learning and Deep Learning

## Description
Protein superimposition based on surface shape can allow comparison of widely divergent proteins and identify proteins with similar functions. However, state-of-the-art approaches use optimization methods that are computationally expensive, which means that a more efficient method is needed. In this project, Random Forest, Multi-layer Perceptron and Convolutional Neural Networks regressor models are used in order to study the generation of either three rotation angles to align two shapes, or a similarity score (Zeal score) between the two shapes. The models predicting the three rotation angles obtained a Mean-Squared Error between 0.0308 and 0.0426, and the models outputting the Zeal score obtained a Mean-
Squared Error between 0.0016 and 0.0029. However, more data is needed, in order to increase the performance on real cases. The developed program will be part of a pipeline for design of new proteins.


## Visuals
The idea of the whole project can be summarised in the Figure below:

![image](/uploads/bee3ebca5023b5521667ee4bd129dc61/image.png)

The project followed the classical steps of a Machine Learning project, which are:

![image](/uploads/0ca311d2fcb33fcfde22af4af499f759/image.png)

The dataset was generated by the authors and it involved several steps:

![image](/uploads/b72effedb51182951e6f9d3767426d20/image.png)

In the end, the dataset consists of:

![image](/uploads/2df87a2212c5ea865f5c68406dab0cab/image.png)

Two approaches have been tried when developing the models:

First approach
- Input: zernike descriptors original protein + zernike descriptors rotated protein
- Output: rotation values

Second approach
- Input: zernike descriptors original protein + zernike descriptors rotated protein + rotation values
- Output: zeal score

The performance of the models:

![image](/uploads/0bc16fb2d736909640ebfc2a44880b82/image.png)


## Installation
This project was developed in Python 3.7 using PyCharm IDE. 

List of used packages:
- PyRosetta - in general, it's used for building molecular modeling algorithms; in this project, it's used for working with proteins shapes 
- numpy, pandas, seaborn, matplotlib - for working with data, analyzing and visualizing it 
- sklearn - for Machine Learning models
- keras, tensorflow - for Deep Learning models

It should be mentioned that this project was developed on a Linux server from Andrelab and all the needed packages were already installed. 

## Usage
A Linux computer is recommended when running this application. 

In order to run the code, type: python main.py in a command terminal.

The project has the following structure:
- inputs - the folder contains the input files that can be used for generating a dataset
- outputs - the folder contains the generated datasets 
- scripts used for modeling and maniputlating proteins: zeal.py, dataset_creator.py, dataset_creator_rotation.py, dataset_creator_zeal.py
- script used for genrating the dataset: rotation_axis_example.py (function main_single_file() generates a dataset for only one protein, function_main_multiple_files() generates a dataset for multiple proteins)
- scripts used for defining the models: random_forest.py, multioutput_random_forest.py, mlp_regression.py, cnn.py, multiotput_cnn.py
- script for visualizing the zernike descriptors of a protein and its rotated version: zernike.py
- main.py - main script that should be used for calling any desired functionallity 

## Support
Theodora Gaiceanu: th6636ga-s@student.lu.se
Diego Figueroa: di4642fi-s@student.lu.se

## Roadmap
- test the models using more data
- use 2D convolutional layers for the models predicting the rotation values


## Authors and acknowledgment
Authors: Theodora Gaiceanu, Diego Figueroa

The authors would like to thank to their supervisor, Daniel Varela, from Andrelab, a laboratory inside the Biochemistry and Structural Biology Department at Lund University.


